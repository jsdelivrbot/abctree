// License information: MIT License
//
// Copyright (c) Chris Schalick 2015 All Rights Reserved.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is furnished
// to do so, subject to the following conditions:
//
//   The above copyright notice and this permission notice shall be included in all
//   copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var abctree_style=document.createElement('style');abctree_style.type='text/css';abctree_style.innerHTML='.abctree_leaf { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AMfEi8WbCB2GQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAYElEQVQY032QuQ2AMBAEZxE5ZVERufshpwQ6cAFUQEy0BLYlm8cjbbY3dzqRsc0Xkhhygx4qpV4tmdZW/2QE4ATNC0xHx7c73WVDCNhuktZd1UCMP6bNEPwylOjvgvpvNwXXOMpWayahAAAAAElFTkSuQmCC"); width: 9px; height: 9px; float: left; margin: 3px; }';document.getElementsByTagName('head')[0].appendChild(abctree_style);abctree_style=document.createElement('style');abctree_style.type='text/css';abctree_style.innerHTML='.abctree_expanded { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAIAAABv85FHAAAAT0lEQVQImWNowA0YGhoarn7+j4kQcq9//n/98//bX//f/Pz/5uf/17+Q5N78/P/2FwpCyDG6VSEjFLlPv3Hb9/UPOkKR+/EXKgphQOVwAQAPSLGYw3tZHAAAAABJRU5ErkJggg=="); width: 9px; height: 9px; float: left; margin: 3px; }';document.getElementsByTagName('head')[0].appendChild(abctree_style);abctree_style=document.createElement('style');abctree_style.type='text/css';abctree_style.innerHTML='.abctree_collapsed { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAIAAABv85FHAAAAXElEQVQImXXNQQrAIAwEQP1cHuUpn/QVxksl0FjL9qBQpXXZw8IE4ngfx8yx4NvXkiEZPAUxiCHVycSQKzyFWJAr8myewtzFjgv94uefNmgb1vdi5w1tiGWMYbs8uiCoqOdNhIkAAAAASUVORK5CYII="); width: 9px; height: 9px; float: left; margin: 3px; }';document.getElementsByTagName('head')[0].appendChild(abctree_style);var abctree=function(id,parent_id){var root=this;this.id=id;this.nodes=[];this.indent=0;this.elem=document.createElement("table");this.elem.id=id;document.getElementById(parent_id).appendChild(this.elem);return this;}
abctree.prototype.node=function(id,val){var kid=new abctree_node(this.root,this.elem,id,val);this.nodes.push(kid);return kid;};abctree.prototype.all_below=function(){var below=[];for(var x=0;x<this.nodes.length;x++)
below.push(this.nodes[x]);for(var x=0;x<this.nodes.length;x++)
below=below.concat(this.nodes[x].all_below());return below;};var abctree_node=function(parent,table,id,val){this.id=id;this.nodes=[];this.parent=parent;this.indent=0;this.elem=document.createElement("tr");this.elem.style.display="block";this.elem.id=id;this.elem.innerHTML="<div id="+id+".img></div>"+val;this.elem.children[0].className="abctree_leaf";this.collapsed=true;this.table=table;this.table.appendChild(this.elem);return this;};abctree_node.prototype.hide=function(){this.elem.style.display="none";};abctree_node.prototype.show=function(){this.elem.style.display="block";};abctree_node.prototype.all_below=function(filter){var below=[];for(var x=0;x<this.nodes.length;x++){below.push(this.nodes[x]);if(typeof filter=="undefined")
below=below.concat(this.nodes[x].all_below(filter));else if((filter=="expanded")&&(!this.nodes[x].collapsed))
below=below.concat(this.nodes[x].all_below(filter));}
return below;};abctree_node.prototype.collapse=function(item){if(item.elem.children[0].className!="abctree_leaf"){item.elem.children[0].className="abctree_collapsed";item.collapsed=true;var below=item.all_below();below.forEach(function(e){e.hide();});}};abctree_node.prototype.expand=function(item){if(item.elem.children[0].className!="abctree_leaf"){item.elem.children[0].className="abctree_expanded";item.collapsed=false;var below=item.nodes;var below=below.concat(item.all_below("expanded"));below.forEach(function(e){e.show();});}};abctree_node.prototype.toggle_expanded=function(item){if(item.elem.children[0].className=="abctree_expanded")
item.collapse(item);else if(item.elem.children[0].className=="abctree_collapsed")
item.expand(item);};abctree_node.prototype.make_callback=function(call,arg){var ret=function(){return call(arg);};return ret;}
abctree_node.prototype.add_child=function(id,val){var child=new abctree_node(this,this.table,id,val);child.indent=this.indent+10;child.elem.style.margin="0px 0px 0px "+child.indent+"px";child.elem.style.display="none";child.parent=this;this.elem.children[0].className="abctree_collapsed";var callback=this.make_callback(this.toggle_expanded,this);this.elem.children[0].onclick=callback;this.nodes.push(child);return child;}
abctree_node.prototype.get_child_by_id=function(id){for(var x=0;x<nodes.length;x++)
if(nodes[x].id==id)
return nodes[x];return null;}